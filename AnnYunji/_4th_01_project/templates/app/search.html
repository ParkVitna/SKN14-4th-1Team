{% extends "layout/base.html" %}
{% load static %}

{% block title %}ì˜ì–‘ì œ ê²€ìƒ‰í•˜ê¸° Â· NutriWise{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/search.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<style>
</style>
{% endblock %}

{% block content %}
<section class="container mt-5">
  <h2 class="text-center fw-bold mb-4">ì›í•˜ëŠ” ì˜ì–‘ì œë¥¼ ê²€ìƒ‰í•´ë³´ì„¸ìš”</h2>

  <!-- ê²€ìƒ‰ í¼ -->
  <form method="post" enctype="multipart/form-data" class="d-flex justify-content-center align-items-center gap-2 mb-4">
    {% csrf_token %}
    <input type="text" name="q" class="form-control w-50" placeholder="ì œí’ˆëª… / ì„±ë¶„ / ë¸Œëœë“œë¡œ ê²€ìƒ‰" value="{{ request.POST.q }}">

    <!-- ì¹´ë©”ë¼ ë²„íŠ¼ -->
    <label class="camera-btn" title="ì´ë¯¸ì§€ ì—…ë¡œë“œ">
      <input type="file" name="image" id="image" class="d-none" accept="image/*" onchange="this.form.submit()">
      <i class="bi bi-camera"></i>
    </label>

    <button type="submit" class="btn btn-success">
      ğŸ” ê²€ìƒ‰
    </button>
  </form>

  {% if response_list %}
  <h5 class="mb-3 text-success fw-bold">ğŸ§¾ ê²€ìƒ‰ ê²°ê³¼</h5>

  <div class="row">
    <!-- ì´ë¯¸ì§€ê°€ ìˆì„ ë•Œë§Œ ì¢Œì¸¡ì— ì´ë¯¸ì§€ ì¹´ë“œ -->
    {% if image_url %}
    <div class="col-md-4 image-container">
      <div class="card mb-4">
        <div class="card-header fw-bold">ğŸ“¸ ì—…ë¡œë“œí•œ ì´ë¯¸ì§€</div>
        <img src="{{ image_url }}" class="uploaded-image" alt="Uploaded Image">
      </div>
    </div>
    {% endif %}

    <!-- ê²€ìƒ‰ ê²°ê³¼ ì•„ì½”ë””ì–¸ -->
    <div class="{% if image_url %}col-md-8{% else %}col-md-12{% endif %}">
      <div class="accordion" id="productAccordion">
        {% for item in response_list %}
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-{{ forloop.counter }}">
            <button class="accordion-button collapsed" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapse-{{ forloop.counter }}"
                    aria-expanded="false"
                    aria-controls="collapse-{{ forloop.counter }}">
              {{ item.name }}
            </button>
          </h2>
          <div id="collapse-{{ forloop.counter }}"
               class="accordion-collapse collapse"
               aria-labelledby="heading-{{ forloop.counter }}"
               data-bs-parent="#productAccordion">
            <div class="accordion-body">
              {% if item.brand %}<p><strong>ë¸Œëœë“œ:</strong> {{ item.brand }}</p>{% endif %}
              {% if item.benefits %}<p><strong>ê¸°ëŒ€íš¨ê³¼:</strong> {{ item.benefits }}</p>{% endif %}
              {% if item.how_to_take %}<p><strong>ì„­ì·¨ ë°©ë²•:</strong> {{ item.how_to_take }}</p>{% endif %}
              {% if item.ingredients %}<p><strong>ì„±ë¶„:</strong> {{ item.ingredients }}</p>{% endif %}
              {% if item.cautions %}<p><strong>ì£¼ì˜ì‚¬í•­:</strong> {{ item.cautions }}</p>{% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
  {% endif %}
</section>
{% endblock %}

{% block script %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
{% endblock %}
