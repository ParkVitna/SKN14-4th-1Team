{% extends "layout/base.html" %}
{% load static %}

{% block title %}영양제 검색하기 · NutriWise{% endblock %}
{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/search.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
{% endblock %}

{% block content %}
<section class="nw-search container mt-5">
  <h1 class="nw-search__title text-center mb-4">원하는 영양제를 검색해보세요</h1>

  <!-- 🔍 기존 검색바 유지 -->
  <form action="#" method="post" enctype="multipart/form-data" class="nw-search__form mb-5">
    {% csrf_token %}
    <input type="text" name="q" class="nw-search__input" placeholder="제품명 / 성분 / 브랜드로 검색" value="{{ request.GET.q }}">
    
    <!-- 이미지/카메라 업로드 -->
    <label class="nw-search__btn nw-search__btn--icon" title="이미지로 검색">
      <input type="file" name="image" accept="image/*" class="nw-search__file" onchange="this.form.submit()">
      📷
    </label>

    <button type="submit" class="nw-search__btn nw-search__btn--primary">
      🔍 검색
    </button>
  </form>

    <!-- 결과 출력 -->
    {% if response_list or image_url %}
    <div class="row mt-5">
      <!-- 왼쪽: 업로드 이미지 -->
      <div class="col-md-4">
        {% if image_url %}
        <div class="card mb-4 shadow-sm">
          <div class="card-header text-center fw-semibold">📸 업로드한 이미지</div>
          <img src="{{ image_url }}" alt="업로드 이미지" class="card-img-top" style="max-height: 300px; object-fit: contain;">
        </div>
        {% endif %}
      </div>

      <!-- 오른쪽: 추천 결과 -->
      <div class="col-md-8">
        {% if response_list %}
        <h5 class="mb-3 text-success fw-bold">🧾 검색 결과</h5>
        {% for item in response_list %}
          <div class="card mb-4 shadow-sm">
            <div class="card-body">
              <h6 class="card-title text-primary fw-semibold">📦 {{ item.name }}</h6>
              <pre class="card-text" style="white-space: pre-wrap;">{{ item.detail }}</pre>
            </div>
          </div>
        {% endfor %}
        {% endif %}
      </div>
    </div>
    {% endif %}

  <!-- 인기 검색어 -->
  <div class="nw-search__meta mt-5">
    <span class="tag">비타민D</span>
    <span class="tag">오메가3</span>
    <span class="tag">마그네슘</span>
  </div>
</section>
{% endblock %}


